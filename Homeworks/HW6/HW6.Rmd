---
title: "PSTAT 174/274 Spring 2023 Homework 6"
author: "Dylan Berneman"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(latex2exp)


```

### Question 1
The three models AR(2), MA(1), and ARMA(2,1) are fitted to the following time series:


| Year | Quarter 1 | Quarter 2 | Quarter 3 | Quarter 4 |
|:-------:|:------:|:-----------:|:---------:|:--------:| 
| 2010 | 112 | 104 | 100 | 96 |
| 2011 | 101 | 101 | 105 | 94 |
| 2012 | 106 | 106 | 108 | 110 |
\


AR(2)\

|  | ar1 | ar2 | intercept | 
|:-------:|:------:|:-----------:|:---------:|
|  | 0.2618 | 0.0868 | 104.227 |
| st. error | 0.3289 | 0.3326 | 2.372 |
| $\sigma^2$ = 25.02 |  | log likelihood = -36.4 |  |



  Year 2010 2011 2012
Quarter 1 112
101 106
Quarter 2 104
101 106
Quarter 3 100 105 108
Quarter 4 96
94 110
st. error σ2 = 25.66
  The results using R are as follows: AR(2):
MA(1):
intercept 103.798
1.7373
log likelihood = -36.51
      st. error σ2 = 25.02
ARMA(2,1):
intercept 104.227 2.372
ar2 0.4437
0.33267
log likelihood = -36.02
ma1 0.1899 0.2574
ar1 0.2618 0.3289
ar2 0.0868 0.3326
log likelihood = -36.4
ar1 -0.5547
0.3329
      st. error σ2 = 21.31
intercept 0.235 2.4584
ma1
0.9779 104.4542
   The models are ranked using Akaike Information Criterion, Corrected for bias (AICC) (see §11.3 of Lecture Notes or slide 32 of week 5).
AICC = −2× log-likelihood+2 × rn where n is the sample size and r is the number of free parameters, n−r−1
most often r = p + q + 1.
Determine the order from the best to worst model. Give full explanation on how you arrived to your
answer. Show calculations.
A. AR(2), MA(1), ARMA (2,1) B. AR(2), ARMA (2,1), MA(1) C. MA(1), AR(2), ARMA (2,1) D. MA(1), ARMA (2,1), AR(2) E. ARMA (2,1), AR(2), MA(1).
2. In modeling the weekly sales of a certain commodity over the past six months, the time series model Xt − φ1Xt−1 = Zt + θ1Zt−1 was thought to be appropriate. Suppose the model was fitted and the autocorrelations of the residuals were:
k 12345678 ρˆWˆ (k) -.04 -.50 .03 -.01 .01 .02 .03 -.01 st. dev ρˆWˆ (k) .08 .10 .11 .11 .11 .11 .11 .11
Is the assumed model really appropriate? If not, how would you modify the model? Explain.
Hint: Check slides 8 - 9 of Lecture 11 for the 95% confidence intervals for autocorrelation function of the fitted residuals. You might also find slide 26 of Week 2 and slide 15 of Lecture 11 useful.
3. Suppose that in a sample of size 100 from an AR(1) process with mean μ, φ = 0.6, and σ2 = 2, we obtain x ̄100 = 0.271. Construct an approximate 95% confidence interval for μ. Are the data compatible with the hypothesis that μ = 0?
Help: (i) Here σ2 ≡ σZ2 is the variance of noise Zt.
(ii) Large sample distribution of X ̄n is given as follows (See, for example, slide 48 or §10.1 of Week 4): For n large, distribution of the sample mean X ̄n is approximately normal with mean μ ≡ EXt and variance n−1v, where v ≈ γX (0) + 2 P∞h=1 γX (h).
(iii) For ACVF for AR(1) process see slide 43 of Week 2.
  
The following problem is for students enrolled in PSTAT 274 ONLY
G1. Two hundred observations of a time series, X1, . . . , X200, gave the following sample statistics: sam- ple mean: x ̄200 = 3.82; sample variance: γˆ(0) = 1.15; sample ACF: ρˆ(1) = .427, ρˆ(2) = .475, ρˆ(3) = .169.
(a) Based on these sample statistics, is it reasonable to suppose that {Xt − μ} is a white noise? (b) Assuming that {Xt − μ} can be modeled as the AR(2) process,
Xt −μ−φ1(Xt−1 −μ)−φ2(Xt−2 −μ)=Zt,
where Zt ∼ IID(0, σZ2 ), find estimates of μ, φ1, φ2, and σZ2 .
(c) Assuming that the data was generated from an AR(2) model, derive estimates of the PACF for all lags h ≥ 1.