---
title: "Project"
author: "Dylan Berneman"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# install.packages('astsa')
# install.packages('tseries')
# install.packages('basicTrendline')
# install.packages('distributional')
# install.packages('FinTS')
# install.packages('FitARMA')
# install.packages("forecast")
# install.packages('ggplot2')
# install.packages("ggfortify")
# install.packages('latex2exp')
# install.packages('polynom')
# install.packages('sarima')
# install.packages("MuMIn")
library(devtools)
library(tseries)
library(MuMIn)
library(astsa)
library(basicTrendline)
devtools::install_github("FinYang/tsdl")
library(tsdl)
library(dplyr)
library(FinTS)
library(FitARMA)
library(forecast)
library(ggplot2)
library(latex2exp)
library(ggfortify)
library(MASS)
library(polynom)
library(readr)
library(readxl)
library(sarima)
library(tinytex)

```

# Original Dataset
```{r}
options(scipen = 9)
covid <- read.csv("owid-covid-data 2.csv")

covid[(is.na(covid))]<-0

covid <- covid %>%
  group_by(date) %>%
  summarise(across(c(total_cases, new_cases, new_cases_smoothed, total_deaths, new_deaths, new_deaths_smoothed), sum))

covid["Smoothed_New_Case_Fatality_Rate"] = NA

for(i in 1:1225){
  covid$Smoothed_New_Case_Fatality_Rate[i] = covid$new_deaths_smoothed[i] / covid$new_cases_smoothed[i]}

covid <- covid[346:1225,]

Mortality = ts(covid$Smoothed_New_Case_Fatality_Rate)
plot.ts(Mortality)
nt=length(Mortality)
abline(h=mean(Mortality), col= "blue")
fit <- lm(Mortality ~ as.numeric(1:nt))
abline(fit, col="red")
hist(Mortality, col="light blue", xlab="", main="histogram; Mortality Data")
acf(Mortality)
var(Mortality)
```
\
# Transformed Dataset
```{r}
# To choose parameter λ of the Box-Cox transformation for datset Mortality: 

bcTransform <- boxcox(Mortality~ as.numeric(1:length(Mortality)))        # plot the graph

bcTransform$x[which(bcTransform$y == max(bcTransform$y))] # gives the value of λ

lambda=bcTransform$x[which(bcTransform$y == max(bcTransform$y))]

# Perform transformations, plot transformed data, histograms:
  
lambda=bcTransform$x[which(bcTransform$y == max(bcTransform$y))]
Mortality.bc = (1/lambda)*(Mortality^lambda-1)
Mortality.log <- log(Mortality)
Mortality.sqrt <- sqrt(Mortality)
Mortality.sq <- Mortality^2

plot.ts(Mortality)
abline(h=mean(Mortality), col= "blue")
abline(lm(Mortality ~ as.numeric(1:length(Mortality))), col="red")
x=acf2(Mortality)

plot.ts(Mortality.bc)
abline(h=mean(Mortality.bc), col= "blue")
abline(lm(Mortality.bc ~ as.numeric(1:length(Mortality.bc))), col="red")
x=acf2(Mortality.bc)

plot.ts(Mortality.log)
abline(h=mean(Mortality.log), col= "blue")
abline(lm(Mortality.log ~ as.numeric(1:length(Mortality.log))), col="red")
x=acf2(Mortality.log)

plot.ts(Mortality.sqrt)
abline(h=mean(Mortality.sqrt), col= "blue")
abline(lm(Mortality.sqrt ~ as.numeric(1:length(Mortality.sqrt))), col="red")
x=acf2(Mortality.sqrt)

plot.ts(Mortality.sq)
abline(h=mean(Mortality.sq), col= "blue")
abline(lm(Mortality.sq ~ as.numeric(1:length(Mortality.sq))), col="red")
x=acf2(Mortality.sq)

hist(Mortality, col="light blue", xlab="", main="histogram; Mortality Data")
hist(Mortality.log, col="light blue", xlab="", main="histogram; ln(Mortality)") 
hist(Mortality.bc, col="light blue", xlab="", main="histogram; bc(Mortality)")
hist(Mortality.sqrt, col="light blue", xlab="", main="histogram; sqrt(Mortality)")
```

# Differencing
```{r}
# To produce decomposition of Mortality:
x <- ts(as.ts(Mortality), frequency = 7)
decomp1 <- decompose(x)
plot(decomp1)

y <- ts(as.ts(Mortality), frequency = 12)
decomp2 <- decompose(y)
plot(decomp2)

z <- ts(as.ts(Mortality), frequency = 14)
decomp3 <- decompose(z)
plot(decomp3)

Frame = data.frame(matrix(nrow=8, ncol=6))
colnames(Frame) <- c("Model", "Nonseasonal", "Seasonal", "Mean", "Variance", "AICc")
Frame$Model <- c("Mortality", "Mortality_1", "Mortality_7", "Mortality_12", "Mortality_14", "Mortality_1.7", "Mortality_1.12", "Mortality_1.14")
Frame$Nonseasonal[1:8] <- c("None", 1, "None", "None", "None", 1, 1, 1)
Frame$Seasonal[1:8] <- c("None", "None", 7, 12, 14, 7, 12, 14)

# Original
plot.ts(Mortality)
nt=length(Mortality)
abline(h=mean(Mortality), col= "blue")
fit <- lm(Mortality ~ as.numeric(1:nt))
abline(fit, col="red")
x = arima(Mortality, order=c(0,0,0), method="ML")
Frame$AICc[1]=AICc(x)
Frame$Mean[1] = mean(Mortality)
Frame$Variance[1] = var(Mortality)

# Differencing Mortality:

Mortality_1 <- diff(Mortality, lag=1)
fit <- lm(Mortality_1 ~ as.numeric(1:length(Mortality_1)))
plot.ts(Mortality_1, main="(Mortality) differenced at lag 1");
abline(fit, col="red") 
abline(h=mean(Mortality_1), col="blue")
x = arima(Mortality_1, order=c(0,0,0), method="ML")
Frame$AICc[2]=AICc(x)
Frame$Mean[2] = mean(Mortality_1)
Frame$Variance[2] = var(Mortality_1)

Mortality_7 <- diff(Mortality, lag=7)
fit <- lm(Mortality_7 ~ as.numeric(1:length(Mortality_7)))
plot.ts(Mortality_7, main="(Mortality) differenced at lag 7")
abline(fit, col="red")
abline(h=mean(Mortality_7), col="blue")
x = arima(Mortality_7, order=c(0,0,0), method="ML")
Frame$AICc[3]=AICc(x)
Frame$Mean[3] = mean(Mortality_7)
Frame$Variance[3] = var(Mortality_7)

Mortality_12 <- diff(Mortality, lag=12)
fit <- lm(Mortality_12 ~ as.numeric(1:length(Mortality_12)))
plot.ts(Mortality_12, main="(Mortality) differenced at lag 12")
abline(fit, col="red")
abline(h=mean(Mortality_12), col="blue")
x = arima(Mortality_12, order=c(0,0,0), method="ML")
Frame$AICc[4]=AICc(x)
Frame$Mean[4] = mean(Mortality_12)
Frame$Variance[4] = var(Mortality_12)

Mortality_14 <- diff(Mortality, lag=14)
fit <- lm(Mortality_14 ~ as.numeric(1:length(Mortality_14)))
plot.ts(Mortality_14, main="(Mortality) differenced at lag 14")
abline(fit, col="red")
abline(h=mean(Mortality_14), col="blue")
x = arima(Mortality_14, order=c(0,0,0), method="ML")
Frame$AICc[5]=AICc(x)
Frame$Mean[5] = mean(Mortality_14)
Frame$Variance[5] = var(Mortality_14)

Mortality_1.7 <- diff(Mortality_1, lag=7)
fit <- lm(Mortality_1.7 ~ as.numeric(1:length(Mortality_1.7)))
plot.ts(Mortality_1.7, main="(Mortality) differenced at lag 1 and lag 7")
abline(fit, col="red")
abline(h=mean(Mortality_1.7), col="blue")
x = arima(Mortality_1.7, order=c(0,0,0), method="ML")
Frame$AICc[6]=AICc(x)
Frame$Mean[6] = mean(Mortality_1.7)
Frame$Variance[6] = var(Mortality_1.7)

Mortality_1.12 <- diff(Mortality_1, lag=12)
fit <- lm(Mortality_1.12 ~ as.numeric(1:length(Mortality_1.12)))
plot.ts(Mortality_1.12, main="(Mortality) differenced at lag 1 and lag 12")
abline(fit, col="red")
abline(h=mean(Mortality_1.12), col="blue")
x = arima(Mortality_1.12, order=c(0,0,0), method="ML")
Frame$AICc[7]=AICc(x)
Frame$Mean[7] = mean(Mortality_1.12)
Frame$Variance[7] = var(Mortality_1.12)

Mortality_1.14 <- diff(Mortality_1, lag=14)
fit <- lm(Mortality_1.14 ~ as.numeric(1:length(Mortality_1.14)))
plot.ts(Mortality_1.14, main="(Mortality) differenced at lag 1 and lag 14")
abline(fit, col="red")
abline(h=mean(Mortality_1.14), col="blue")
x = arima(Mortality_1.14, order=c(0,0,0), method="ML")
Frame$AICc[8]=AICc(x)
Frame$Mean[8] = mean(Mortality_1.14)
Frame$Variance[8] = var(Mortality_1.14)

Frame["Lowest AICc"] <- as.integer(rank(Frame$AICc))
Frame["Lowest Variance"] <- as.integer(rank(Frame$Variance))
Frame = Frame[1:8, c(1:5, 7, 6, 8)]
Frame

```
\
Since the trend line is the same as the mean when differencing at lag 1 and at either lag 7, lag 12, or lag 14, we will only be testing models that have a nonseasonal diference at lag 1. In addition, the largest AICcs were those with a nonseasonal and a seasonal difference.

# Differencing ACF/PACF
```{r}
x=acf2(Mortality)
x=acf2(Mortality_1)
x=acf2(Mortality_7)
x=acf2(Mortality_12)
x=acf2(Mortality_14)
x=acf2(Mortality_1.7)
x=acf2(Mortality_1.12)
x=acf2(Mortality_1.14)
```

# Test
```{r}
# Trying models. Some R Commands:

Data = data.frame(matrix(nrow=144, ncol=2))
colnames(Data) = c("Model", "AICc")

loop.s = c(0,7,12,14)
loop.p = c(0,1,2,3,4,5)
loop.q = c(0,1,2,3,4,5)

i = 1
for(s in loop.s){
  for(p in loop.p){
    for(q in loop.q){
      if(s == 0){
        Data[i, 1] = paste0("ARIMA(", p, "_1_", q, ")")
        assign(paste0("ARIMA(", p, "_1_", q, ")"), arima(Mortality_1, order=c(p,0,q), method="ML"))
        Data[i, 2] = AICc(get(paste0("ARIMA(", p, "_1_", q, ")")))
        x=acf2(get(paste0("ARIMA(", p, "_1_", q, ")"))$residuals, main = paste0("ARIMA(", p, ", 1,", q, ") AICc = ", Data[i,2]))}
      else{
        Data[i, 1] = paste0("SARIMA(", p, "_1_", q, ")x((0,1,0)_", s)
        assign(paste0("SARIMA(", p, "_1_", q, ")x((0,1,0)_", s), arima(Mortality_1, order=c(p,0,q), seasonal=list(order=c(0,1,0), period=s), method="ML"))
        Data[i, 2] = AICc(get(paste0("SARIMA(", p, "_1_", q, ")x((0,1,0)_", s)))
        x=acf2(get(paste0("SARIMA(", p, "_1_", q, ")x((0,1,0)_", s))$residuals, main = paste0("SARIMA(", p, "_1_", q, ")x((0,1,0)_", s, "AICc = ", Data[i,2]))}
      i = i + 1}}}

Data["Lowest AICc"] <- as.integer(rank(Data$AICc))
Data
```
        
        
```{r}     
          acf2(assign(paste0("SARIMA(", p, "_1_", q, ")x(0,1,0)_", s), arima(Mortality_1, order=c(p,0,q), seasonal=list(order=c(0,1,0), period=s), method="ML"))$residuals, main = paste0("SARIMA(", p, "_1_", q, ")x(0,1,0)_", s))}
        else{
          acf2(assign(paste0("SARIMA(", p, "_1_", q, ")x(0,1,0)_", s), arima(Mortality, order=c(p,1,q), seasonal=list(order=c(0,1,0), period=s), method="ML"))$residuals, main = paste0("SARIMA(", p, "_1_", q, ")x(0,1,0)_", s))}}}}}


      
    assign(paste0("ARIMA1_", p, "_1_", q), arima(Mortality_1, order=c(p,1,q), seasonal=list(order=c(0,1,0), period=12), method="ML"))
    acf2(assign(paste0("Residuals_ARIMA_0_1_", i,  "_of_", x), arima(Mortality, order=c(0,1,i), method="ML")$residuals), main = paste0("ARIMA_0_1_", i, " of ", x))
    variable1 = paste0("ARIMA_0_1_", i)
    variable2 = paste0("Residuals_ARIMA0_1_", i,  "_of_", x)
}}

```

```{r}
for(i in 1:3){
  arima(Mortality, order=c(i,1,1), seasonal = list(order = c(0,1,1), period = 12), method="ML")
  acf2(arima(Mortality, order=c(i,1,1), seasonal = list(order = c(0,1,1), period = 12), method="ML"))
  AICc(arima(Mortality, order=c(i,1,1), seasonal = list(order = c(0,1,1), period = 12), method="ML"))
}

# Model
Model1 = arima(Mortality.stat, order=c(0,1,1), seasonal = list(order = c(0,1,1), period = 12), method="ML")

Model1

x = acf2(Model1)

AICc(Model1)








arima(Mortality, order=c(0,1,3), seasonal = list(order = c(0,1,1), period = 12), method="ML")

AICc(arima(Mortality, order=c(0,1,3), seasonal = list(order = c(0,1,1), period = 12), method="ML"));
[1] -441.0091
arima(Mortality, order=c(0,1,3), seasonal = list(order = c(0,1,1), period = 12), fixed = c(NA, 0, NA, NA),
method="ML")
ma1 ma2 ma3 sma1 -0.3353 0 -0.1612 -0.5782
s.e. 0.0810 0 0.0852 0.0796
sigma^2 estimated as 0.00127: log likelihood = 225.38, aic = -442.76
AICc(arima(Mortality, order=c(0,1,3), seasonal = list(order = c(0,1,1), period = 12), fixed = c(NA, 0, NA, NA), method="ML")) [1] -442.4489
32

  • To check invertibility of MA part of model A:
source("plot.roots.R")
plot.roots(NULL,polyroot(c(1, -0.3353, 0, -0.1612)), main="(A) roots of ma part, nonseasonal ")
• Diagnostic checking of model B:
fit <- arima(Mortality, order=c(0,1,1), seasonal = list(order = c(0,1,1), period = 12), method="ML")
res <- residuals(fit)
hist(res,density=20,breaks=20, col="blue", xlab="", prob=TRUE)
m <- mean(res)
std <- sqrt(var(res))
curve( dnorm(x,m,std), add=TRUE )
plot.ts(res)
fitt <- lm(res ~ as.numeric(1:length(res))); abline(fitt, col="red")
abline(h=mean(res), col="blue")
qqnorm(res,main= "Normal Q-Q Plot for Model B")
qqline(res,col="blue"
acf(res, lag.max=40)
pacf(res, lag.max=40)
shapiro.test(res)
Box.test(res, lag = 12, type = c("Box-Pierce"), fitdf = 2) Box.test(res, lag = 12, type = c("Ljung-Box"), fitdf = 2)
Box.test(res^2, lag = 12, type = c("Ljung-Box"), fitdf = 0)
acf(res^2, lag.max=40)
ar(res, aic = TRUE, order.max = NULL, method = c("yule-walker"))

• Forecasting using model A:
install.packages("forecast")
library(forecast)
fit.A <- arima(Mortality, order=c(0,1,3), seasonal = list(order = c(0,1,1), period = 12),
fixed = c(NA, 0, NA, NA), method="ML")
forecast(fit.A) % prints forecasts with prediction bounds in a table
• To produce graph with 12 forecasts on transformed data:
pred.tr <- predict(fit.A, n.ahead = 12)
U.tr= pred.tr$pred + 2*pred.tr$se % upper bound of prediction interval L.tr= pred.tr$pred - 2*pred.tr$se % lower bound
ts.plot(Mortality, xlim=c(1,length(Mortality)+12), ylim = c(min(Mortality),max(U.tr)))
lines(U.tr, col="blue", lty="dashed")
lines(L.tr, col="blue", lty="dashed")
points((length(Mortality)+1):(length(Mortality)+12), pred.tr$pred, col="red")
34

  • To produce graph with forecasts on original data:
pred.orig <- exp(pred.tr$pred)
U= exp(U.tr)
L= exp(L.tr)
ts.plot(Mortality, xlim=c(1,length(Mortality)+12), ylim = c(min(Mortality),max(U))) lines(U, col="blue", lty="dashed")
lines(L, col="blue", lty="dashed")
points((length(Mortality)+1):(length(Mortality)+12), pred.orig, col="red")
• To zoom the graph, starting from entry 100:
ts.plot(Mortality, xlim = c(100,length(Mortality)+12), ylim = c(250,max(U))) lines(U, col="blue", lty="dashed")
lines(L, col="blue", lty="dashed")
points((length(Mortality)+1):(length(Mortality)+12), pred.orig, col="red")
• To plot zoomed forecasts and true values (in Mortality):
ts.plot(Mortality, xlim = c(100,length(Mortality)+12), ylim = c(250,max(U)), col="red") lines(U, col="blue", lty="dashed")
lines(L, col="blue", lty="dashed")
points((length(Mortality)+1):(length(Mortality)+12), pred.orig, col="green")
points((length(Mortality)+1):(length(Mortality)+12), pred.orig, col="black")


```

```{r}



```

```{r}



```

```{r}



```


```{r}
Mortality.diff7 = diff(Mortality, lag=7, differences=2)
Mortality.diff8 = diff(Mortality.diff7, 1)
plot.ts(Mortality.diff)
Mortality.diff_acf1
acf2(Mortality.diff7)

acf2(Mortality.diff8)
var(Mortality.diff)

Mortality.diff2 = diff(Mortality, 2)
plot.ts(Mortality.diff2)
Mortality_acf2 = acf2(Mortality.diff2)
var(Mortality.diff2)

Mortality.diff3 = diff(Mortality, 3)
plot.ts(Mortality.diff3)
Mortality_acf3 = acf2(Mortality.diff3)
var(Mortality.diff3)

Mortality.diff4 = diff(Mortality, 4)
plot.ts(Mortality.diff4)
Mortality_acf4 = acf2(Mortality.diff4)
var(Mortality.diff4)
adf.test
# Diff = 1
var(Mortality.diff) < var(Mortality.diff2)

ar1 = ar(Mortality.diff, aic = FALSE, method="mle") # 12
ar2 = ar(Mortality.diff, aic = FALSE, method="yw") # 29
ar3 = ar(Mortality.diff, aic = TRUE, method="mle") # 10
ar4 = ar(Mortality.diff, aic = TRUE, order.max = 12, method="yw") # 10

source("innovations.R")

acvf = acf(Mortality.diff, plot=FALSE, lag.max = length(Mortality.diff))$acf[,1,1] * var(Mortality.diff) 
m = length(acvf)
lh.ia = innovations.algorithm(m+1, acvf)
lh.ia$thetas[9,1:9] # Preliminary estimates of coefficients for MA(9)
lh.ia$thetas[10,1:10] # Preliminary estimates of coefficients for MA(10)
lh.ia$thetas[11,1:11] # Preliminary estimates of coefficients for MA(11)
lh.ia$thetas[12,1:12] # Preliminary estimates of coefficients for MA(12)

arima1 <- auto.arima(Mortality, start.p = 0, start.q = 0, d=1, start.P = 0, start.Q = 0, stationary=TRUE, seasonal = TRUE, allowmean=TRUE, trace = TRUE) # 5,0,0

fit.ar1 <- arima(Mortality.diff8, order=c(1,1,7), seasonal=list(order=c(6,2,2), period=7))

fit.ar1.1 <- arima(Mortality.diff8, order=c(1,1,7), seasonal=list(order=c(4,2,2), period=7), fixed=c(NA,NA,NA,0,0,NA,NA,NA,NA,NA,NA,NA,NA,NA))

a=acf2(fit.ar1.1$residuals)
acf2(fit.ar1$residuals)
a
fit.ar1
fit.ar2 <- arima(Mortality.diff8, order=c(7,1,7), seasonal=list(order=c(6,2,1), period=7))
acf2(fit.ar2$residuals)

fit.ar2 <- arima(Mortality.diff, order=c(0,0,0))

acf1 = acf2(fit.ar1$residuals)
acf1

fit.ar2 <- arima(Mortality, order=c(8,1,1))
fit.ar2 
acf2 = acf2(fit.ar2$residuals)
acf1 = acf2(fit.ar1$residuals)

fit.sarima = astsa::sarima(Mortality,8,1,1,0,1,0,7, model=TRUE)
acf2(fit.sarima$fit$residuals)

fit.ar3.1
fit.ar3.2

fit.ar3.1 <- arima(Mortality, transform.pars = TRUE, method="ML", order=c(0,1,10), seasonal=list(order=c(0,1,1), period=14), include.mean=TRUE, fixed=c(NA,NA,NA,NA,NA,NA,NA,NA,0,NA,NA))

fit.ar3.2 <- arima(Mortality, transform.pars = TRUE, method="ML", order=c(0,1,10), seasonal=list(order=c(0,1,1), period=14), include.mean=TRUE)
acf2(fit.ar3.1$residuals)

acf2(fit.ar3.2$residuals)
                 
fit.ar3 <- arima(Mortality, order=c(0,1,15), seasonal=list(order=c(0,1,1), period=14), fixed=c(NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0,0,0,0,0,NA), a)

fit.ar4 <- arima(Mortality, order=c(0,1,7), seasonal=list(order=c(0,1,1), period=14))

fit.ar5 <- arima(Mortality, order=c(5,1,10), seasonal=list(order=c(0,1,1), period=14))
fit.ar5
acf5


fit.ar5.1 <- arima(Mortality, order=c(5,1,), seasonal=list(order=c(0,1,1), period=14), fixed = c(0,NA,0,0,NA,0,0,0,0,0,0,NA,NA))

fit.ar5.1
fit.ar5
plot(fit.ar5)
acf3 = acf2(fit.ar3$residuals)
acf3.1 = acf2(fit.ar3.1$residuals)
acf4 = acf2(fit.ar4$residuals)
acf5.1 = acf2(fit.ar5.1$residuals)
acf5 = acf2(fit.ar5$residuals, plot=FALSE)
acf5
fit.ar5
Mortality.diff_acf1 = acf2(Mortality.diff)


fit.ar2 <- arima(Mortality.diff, order=c(10,0,0))
fit.ar3 <- arima(Mortality.diff, order=c(12,0,0))
fit.ar4 <- arima(Mortality.diff, order=c(29,0,0))

fit.ma5 <- arima(Mortality.diff, order=c(0,0,9))
fit.ma6 <- arima(Mortality.diff, order=c(0,0,10))
fit.ma7 <- arima(Mortality.diff, order=c(0,0,11))
fit.ma8 <- arima(Mortality.diff, order=c(0,0,12))

fit.arma9 <- arima(Mortality.diff, order=c(5,0,9)) # 12/14 0.05 < s.e. < 0.21
fit.arma10 <- arima(Mortality.diff, order=c(5,0,10)) # NAN produced
fit.arma11 <- arima(Mortality.diff, order=c(5,0,11)) # all 0.07 < s.e. < 0.77
fit.arma12 <- arima(Mortality.diff, order=c(5,0,12)) # 13/17 0.05 < s.e. < 0.837

fit.arma13 <- arima(Mortality.diff, order=c(10,0,9)) # NAN produced
fit.arma14 <- arima(Mortality.diff, order=c(10,0,10)) # 18/20  0.05 < s.e. < 0.099
fit.arma15 <- arima(Mortality.diff, order=c(10,0,11)) # all 0.97 < s.e. < 0.32
fit.arma16 <- arima(Mortality.diff, order=c(10,0,12)) # all 0.12 < s.e. < 0.61

fit.arma17 <- arima(Mortality.diff, order=c(12,0,9)) # all 0.05 < s.e. < 0.60
fit.arma18 <- arima(Mortality.diff, order=c(12,0,10)) # NAN produced
fit.arma19 <- arima(Mortality.diff, order=c(12,0,11)) # NAN produced
#fit.arma20 <- arima(Mortality.diff, order=c(12,0,12)) # all 0.09 < s.e. < 0.37
#fit.arma21 <- arima(Mortality.diff, order=c(29,0,9)) # NAN produced
#fit.arma22 <- arima(Mortality.diff, order=c(29,0,10)) # NAN produced
# fit.arma23 <- arima(Mortality.diff, order=c(29,0,11)) # NAN produced
# fit.arma24 <- arima(Mortality.diff, order=c(29,0,12)) # NAN produced

# STATIONARY
fit.arma25_10 <- arima(Mortality.diff, order=c(25,0,10)) # NAN produced
# STATIONARY w/out NANs for s.e. 
fit.arma25_9 <- arima(Mortality.diff, order=c(25,0,9)) # NAN produced

Data <- data.frame(c(AICc(fit.ar1),
AICc(fit.ar2),
AICc(fit.ar3),
AICc(fit.ar4),
AICc(fit.ma5),
AICc(fit.ma6),
AICc(fit.ma7),
AICc(fit.ma8),
AICc(fit.arma9),
AICc(fit.arma10),
AICc(fit.arma11),
AICc(fit.arma12),
AICc(fit.arma13),
AICc(fit.arma14),
AICc(fit.arma15),
AICc(fit.arma16),
AICc(fit.arma17),
AICc(fit.arma18),
AICc(fit.arma19),
#AICc(fit.arma20),
#AICc(fit.arma21),
#AICc(fit.arma22),
AICc(fit.arma25_10),
AICc(fit.arma25_9)))

rownames(Data) <- c("AR(5)", "AR(10)", "AR(12)", "AR(29)", "MA(9)", "MA(10)", "MA(11)", "MA(12)", "ARMA(5,9)", "ARMA(5,10)", "ARMA(5,11)", "ARMA(5,12)", "ARMA(10,9)", "ARMA(10,10)", "ARMA(10,11)", "ARMA(10,12)", "ARMA(12,9)", "ARMA(12,10)", "ARMA(12,11)", "ARMA(25,10)", "ARMA(25,9)")
colnames(Data) <- c("AICc")

Data["Lowest AICc"] <- as.integer(rank(Data$AICc))
Data

acf1 = acf2(fit.ar1$residuals)
acf2 = acf2(fit.ar2$residuals)
acf3 = acf2(fit.ar3$residuals)
acf4 = acf2(fit.ar4$residuals)
acf5 = acf2(fit.ma5$residuals)
acf6 = acf2(fit.ma6$residuals)
acf7 = acf2(fit.ma7$residuals)
acf8 = acf2(fit.ma8$residuals)
acf9 = acf2(fit.arma9$residuals)
acf10 = acf2(fit.arma10$residuals)
acf11 = acf2(fit.arma11$residuals)
acf12 = acf2(fit.arma12$residuals)
acf13 = acf2(fit.arma13$residuals)
acf14 = acf2(fit.arma14$residuals)
acf15 = acf2(fit.arma15$residuals)
acf16 = acf2(fit.arma16$residuals)
acf17 = acf2(fit.arma17$residuals)
acf18 = acf2(fit.arma18$residuals)
acf19 = acf2(fit.arma19$residuals)
#acf20 = acf2(fit.arma20$residuals)
#acf21 = acf2(fit.arma21$residuals)
#acf22 = acf2(fit.arma22$residuals)
acf23 = acf2(fit.arma25_10$residuals)
acf24 = acf2(fit.arma25_9$residuals)

```